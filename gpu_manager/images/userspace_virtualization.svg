<svg width="900" height="650" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="appGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#FF9800;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#F57C00;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="hamiGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#2196F3;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#1976D2;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="kernelGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#4CAF50;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#45a049;stop-opacity:1" />
    </linearGradient>
  </defs>
  
  <!-- 标题 -->
  <text x="450" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="24" font-weight="bold" fill="#333">用户态GPU资源管理架构 (HAMi)</text>
  
  <!-- 应用层 -->
  <rect x="50" y="70" width="800" height="100" fill="url(#appGrad)" stroke="#F57C00" stroke-width="2" rx="10"/>
  <text x="70" y="100" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">应用层</text>
  
  <!-- 应用程序 -->
  <rect x="80" y="110" width="120" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
  <text x="140" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">PyTorch应用</text>
  
  <rect x="220" y="110" width="120" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
  <text x="280" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">TensorFlow应用</text>
  
  <rect x="360" y="110" width="120" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
  <text x="420" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">CUDA应用</text>
  
  <rect x="500" y="110" width="120" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
  <text x="560" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">推理服务</text>
  
  <rect x="640" y="110" width="120" height="40" fill="#FFF3E0" stroke="#FF9800" stroke-width="1" rx="5"/>
  <text x="700" y="135" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">训练任务</text>
  
  <!-- HAMi资源管理层 -->
  <rect x="50" y="190" width="800" height="180" fill="url(#hamiGrad)" stroke="#1976D2" stroke-width="2" rx="10"/>
  <text x="70" y="220" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">HAMi 资源管理层 (用户态)</text>
  
  <!-- API拦截模块 -->
  <rect x="80" y="240" width="150" height="60" fill="#E3F2FD" stroke="#2196F3" stroke-width="1" rx="5"/>
  <text x="155" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">API拦截模块</text>
  <text x="155" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">CUDA API Hook</text>
  <text x="155" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">动态库替换</text>
  
  <!-- 资源管理器 -->
  <rect x="250" y="240" width="150" height="60" fill="#E3F2FD" stroke="#2196F3" stroke-width="1" rx="5"/>
  <text x="325" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">资源管理器</text>
  <text x="325" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">显存分配</text>
  <text x="325" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">计算资源调度</text>
  
  <!-- 调度器 -->
  <rect x="420" y="240" width="150" height="60" fill="#E3F2FD" stroke="#2196F3" stroke-width="1" rx="5"/>
  <text x="495" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">任务调度器</text>
  <text x="495" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">优先级调度</text>
  <text x="495" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">负载均衡</text>
  
  <!-- 监控模块 -->
  <rect x="590" y="240" width="150" height="60" fill="#E3F2FD" stroke="#2196F3" stroke-width="1" rx="5"/>
  <text x="665" y="265" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">监控模块</text>
  <text x="665" y="280" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">性能监控</text>
  <text x="665" y="295" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">资源统计</text>
  
  <!-- GPU资源配额池 -->
  <rect x="80" y="320" width="660" height="50" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="90" y="335" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#333">GPU资源配额池</text>
  
  <!-- 资源配额实例 -->
  <rect x="100" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="140" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-1</text>
  
  <rect x="200" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="240" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-2</text>
  
  <rect x="300" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="340" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-3</text>
  
  <rect x="400" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="440" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-4</text>
  
  <rect x="500" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="540" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-5</text>
  
  <rect x="600" y="340" width="80" height="22" fill="#C8E6C9" stroke="#4CAF50" stroke-width="1" rx="3"/>
  <text x="640" y="355" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#333">配额-N</text>
  
  <!-- 系统层 -->
  <rect x="50" y="400" width="800" height="80" fill="url(#kernelGrad)" stroke="#45a049" stroke-width="2" rx="10"/>
  <text x="70" y="430" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">系统层 (内核态)</text>
  
  <!-- 系统组件 -->
  <rect x="80" y="440" width="120" height="30" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="140" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">操作系统内核</text>
  
  <rect x="220" y="440" width="120" height="30" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="280" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">GPU驱动</text>
  
  <rect x="360" y="440" width="120" height="30" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="420" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">CUDA Runtime</text>
  
  <rect x="500" y="440" width="120" height="30" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="560" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">容器运行时</text>
  
  <rect x="640" y="440" width="120" height="30" fill="#E8F5E8" stroke="#4CAF50" stroke-width="1" rx="5"/>
  <text x="700" y="460" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#333">Kubernetes</text>
  
  <!-- 硬件层 -->
  <rect x="50" y="500" width="800" height="80" fill="#424242" stroke="#212121" stroke-width="2" rx="10"/>
  <text x="70" y="530" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="white">硬件层</text>
  
  <!-- GPU硬件 -->
  <rect x="80" y="540" width="150" height="30" fill="#666" stroke="#333" stroke-width="1" rx="5"/>
  <text x="155" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">GPU 1</text>
  
  <rect x="250" y="540" width="150" height="30" fill="#666" stroke="#333" stroke-width="1" rx="5"/>
  <text x="325" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">GPU 2</text>
  
  <rect x="420" y="540" width="150" height="30" fill="#666" stroke="#333" stroke-width="1" rx="5"/>
  <text x="495" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">GPU 3</text>
  
  <rect x="590" y="540" width="150" height="30" fill="#666" stroke="#333" stroke-width="1" rx="5"/>
  <text x="665" y="560" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white">GPU N</text>
  
  <!-- 箭头 -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
    </marker>
  </defs>
  
  <!-- API调用流程箭头 -->
  <line x1="140" y1="170" x2="140" y2="190" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="280" y1="170" x2="280" y2="190" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="420" y1="170" x2="420" y2="190" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="560" y1="170" x2="560" y2="190" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  <line x1="700" y1="170" x2="700" y2="190" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 虚拟化层到系统层 -->
  <line x1="450" y1="380" x2="450" y2="400" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 系统层到硬件层 -->
  <line x1="450" y1="480" x2="450" y2="500" stroke="#666" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- 数据流标签 -->
  <text x="50" y="180" font-family="Arial, sans-serif" font-size="10" fill="#666">API调用</text>
  <text x="50" y="390" font-family="Arial, sans-serif" font-size="10" fill="#666">资源映射</text>
  <text x="50" y="490" font-family="Arial, sans-serif" font-size="10" fill="#666">硬件访问</text>
  
  <!-- 特性说明 -->
  <rect x="50" y="600" width="800" height="50" fill="#FAFAFA" stroke="#E0E0E0" stroke-width="1" rx="5"/>
  <text x="60" y="625" font-family="Arial, sans-serif" font-size="14" font-weight="bold" fill="#333">用户态资源管理特性：</text>
  <text x="60" y="640" font-family="Arial, sans-serif" font-size="12" fill="#666">• 无需内核模块，部署简单</text>
  <text x="250" y="640" font-family="Arial, sans-serif" font-size="12" fill="#666">• 支持多种GPU和框架</text>
  <text x="450" y="640" font-family="Arial, sans-serif" font-size="12" fill="#666">• 动态资源分配和调度</text>
  <text x="650" y="640" font-family="Arial, sans-serif" font-size="12" fill="#666">• 云原生友好</text>
</svg>